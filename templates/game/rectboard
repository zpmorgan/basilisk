
<script language="javascript">
   //set a few globals
   img_base = '[% img_base %]';
   url_base = '[% url_base %]';
   w = [% w %];
   h = [% h %];
   wrap_ns = [% wrap_ns %];
   wrap_ew = [% wrap_ew %];
   twist_ns = [% twist_ns %];
   gameid = [% gameid %];
   side = '[% side %]';
</script>



[% size = board_data.size %]
[% MACRO coordinate_letter_row BLOCK %]
 [% reverse = base AND twist_ns %]
  <tr>
   <td><img src="[%img_base%]/blank.gif" width="31" height="25"> </td>
   [% c=0; WHILE c < w -%]
     [% IF reverse; letter = c_letter(w-c- 1); ELSE; letter = c_letter(c); END -%]
     <td> <img src="[%img_base%]/c[% letter %].gif"> </td>
    [% c=c+1; -%]
   [% END -%]
   <td><img src="[%img_base%]/blank.gif" width="31" height="25"> </td>
  </tr>
[% END %]

[% MACRO row_number_cell(row) BLOCK -%]
  <td><img src="[%img_base%]/c[% h +1 - row %].gif"></td>
[% END %]



<table class="scrolled_board_view">
 <tr> <td>
  [%IF wrap_ns or twist_ns %]
   <td> <img src="[%img_base%]/scroll-up.png" width="40%" onClick="scroll('up')">
  [%END%]
 </tr>
 
 <tr>
   <td>
     [% IF wrap_ew -%]
       <img src="[%img_base%]/scroll-left.png"  width="40%" onClick="scroll('left')">
     [% END -%]
   </td>
  
  <td>
<table id="board" class="Goban" style="background-image: url([%img_base%]/wood.gif);">
 [% coordinate_letter_row(base=0); %]
 [% FOREACH row = board_data -%]
  <tr id="row [% loop.count - 1 %]">
  [% row_number_cell(loop.count) %]
    [%- FOREACH cell = row -%]
      [%- IF cell.ref -%]
        <td id="cell [% cell.node %]" onClick="select('[% cell.node %]')"> 
      [%- ELSE -%]
        <td id="cell [% cell.node %]"> 
      [%- END -%]
          <img id="img [% cell.node %]" src="[%img_base%]/[% cell.g %]"> </td>
    [% END -%]
  [% row_number_cell(loop.count) %]
  </tr>
 [% END %]
 [% coordinate_letter_row(base=1) %]
</table>
  </td>

[%# resuming controls %]
  [%IF wrap_ew %]
   <td> <img src="[%img_base%]/scroll-right.png" width="40%" onClick="scroll('right')"> </td>
  [%END%]
 </tr>
 <tr> <td>
  [%IF wrap_ns or twist_ns %]
   <td> <img src="[%img_base%]/scroll-down.png" width="40%" onClick="scroll('down')">
  [%END%]
 </tr>
</table>


[%# submission controls %]
<form id="move_submit_form" action="">
   <input id="mv_subm_but" value="Submit move" tabindex="3" type="submit" style="display:none;">
</form>


